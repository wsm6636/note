---
created: 2024-06-28T12:30:00
updated: 2024-07-01T11:03
tags:
  - 笔记/文献笔记
  - 笔记
status:
  - done
title: ROS2 Real-time Performance Optimization and Evaluation
TitleTranslation: " ROS2实时性能优化与评估"
Journal or Conference: "Chin. J. Mech. Eng.  Chinese Journal of Mechanical Engineering "
FirstAuthor: YanleiYe
allAuthors:
  - YanleiYe, ZhenguoNie, XinjunLiu, FuguiXie, ZihaoLi, PengLi
Pub.date: 2023-12
DOI: 10.1186/s10033-023-00976-5
zoterolink: zotero://select/library/items/ICFLQ7BC
---


# ROS2 Real-time Performance Optimization and Evaluation
---

# 摘要
与不确定和动态环境的实时交互对于机器人系统实现视觉感知、力交互、空间避障和运动规划等功能至关重要。为了保证系统执行的可靠性和确定性，需要灵活的实时控制系统架构和交互算法。 ROS框架旨在通过提供分布式结构、硬件抽象、消息传递机制和应用程序原型来提高机器人软件开发的可重用性。基于Linux系统的ROS1和ROS2架构，已经构建了丰富的机器人开发生态系统。但由于Linux系统默认设计的公平调度原则以及内核的复杂性，导致系统不具备实时计算能力。为了实现实时和非实时计算的平衡，本文利用ROS2的传输机制，与Linux操作系统的调度机制相结合，利用Preempt_RT来增强ROS1和ROS2的实时计算。 ROS1和ROS2的实时性能评估从多个角度进行，包括吞吐量、传输模式、QoS服务质量、频率、订阅节点数量和EtherCAT主站。本文做出了两个重大贡献：第一，采用Preempt_RT对原生ROS2系统进行优化，有效增强了原生ROS2消息传输的实时性；其次，它对原生和优化的ROS2系统的实时性能进行了全面评估。这一比较阐明了优化的 ROS2 架构在实时性能方面的优势，并通过插图生动地展示了结果。

# 1
开发 ROS2 控制系统需要仔细关注实时性能设计和保证。工业机器人、航空航天设备、医疗机器人、服务机器人和军用机器人都受到严格的实时约束。实时系统是一种能够在精确的时间间隔内响应环境中发生的事件的系统 [1]。因此，优化和评估ROS2的实时性能至关重要，因为它决定了系统对研究人员和工程师的可用性以及如何更好地利用ROS2[2]进行相关研究。

为了解决复杂机器人系统软件开发的困难，人们提出了许多软件概念和架构。近年来，基于组件和模型驱动的开发逐渐引入机器人软件系统的构建中，以简化开发并提高质量。现代机器人控制系统通常被设计为基于组件的分布式系统。使用这种方法的著名系统的例子包括 OROCOS [3]、OpenHRP [4]、YARP [5, 6]、MRDS [7]、Director [8] 和 ROS [9-13]。他们都认为复杂的机器人系统应该由基于组件的软件工程交互模块组成。

机器人操作系统（ROS）因其精简、基于消息和基于工具的设计而受到研究人员和工程师的欢迎。然而，其非实时系统架构使其无法保证容错、截止日期或进程同步。卡拉穆萨达基斯等人。 [14]基于ROS1系统架构设计了一个四足机器人，使用Xenomai补丁来优化原生系统。尽管有这样的改进，ROS 仍然需要大量资源，包括 CPU、内存、网络带宽、线程和内核。它无法有效地管理这些资源来满足时间限制。

机器人操作系统（ROS）因其精简、基于消息和基于工具的设计而受到研究人员和工程师的欢迎。然而，其非实时系统架构使其无法保证容错、截止日期或进程同步。卡拉穆萨达基斯等人。 [14]基于ROS1系统架构设计了一个四足机器人，使用Xenomai补丁来优化原生系统。尽管有这样的改进，ROS 仍然需要大量资源，包括 CPU、内存、网络带宽、线程和内核。它无法有效地管理这些资源来满足时间限制。

实时机器人操作系统（RT-ROS）[15]使用Linux和Nuttx内核创建非实时/实时任务执行环境。这提高了ROS的实时性能，但并不能保证ROS的实时约束。使用RT-ROS需要修改ROS库和节点，难以快速更新和维护。 MICRO-ROS[16]是专门为资源有限的微控制器开发的变体，它是一个轻量级的ROS客户端，可以在STM32等现代32位微控制器上运行。然而，由于资源和计算能力有限，在双臂机器人或大型工程项目的微处理器上部署项目具有挑战性。


随着将研究成果转化为商业产品的需求日益迫切，ROS1作为基础研究平台的局限性日益显现，因为它没有考虑到实时系统、小型嵌入式平台、非理想网络、交叉网络的需求。考虑到平台兼容性和商业产品化。 ROS2使用数据分发服务（DDS）[17, 18]进行通信，可以提高消息传递的实时性能[19, 20]，但这种改进仅针对节点之间的延迟（通常认为是为数百毫秒）。丁等人。 [21]系统地介绍了ROS2系统的架构，并是最早分析ROS2源代码的人之一。丸山等人。 [12]探讨了ROS2在原生内核上的重要实时性能，从多个角度评估了ROS2相对于ROS1的实时性能。 Choi [22]提出了一种优先级驱动的链感知调度器，从调度策略的角度优化ROS2的实时性能，改善端到端延迟。 ROS2.0本身构建在DDS和一些模块之上，构建分布式、实时的解决方案。不过，目前ROS2生态系统大部分都是围绕Linux构建的，实时性能的上限是由操作系统本身决定的。通常ROS2是基于Ubuntu构建的，无法保证系统的实时性能（例如机器人通信周期为1ms，抖动低于200μs）。当机器人的轨迹被精细插值并且系统无法按时传递数据时，机器人的关节运动变得不太平滑。因此，迫切需要在ROS2架构下进行实时性能分析，提高系统的实时性能。



> 🔤Preempt_RT补丁提供了诸如可抢占临界区、可抢占中断处理程序、可抢占“中断禁用”代码序列、内核自旋锁和信号量优先级继承等功能，以及减少延迟的措施。对本机内核的修改包括高精度计时器、线程中断处理程序、睡眠自旋锁、实时互斥体和 RCU 同步机制。为了评估 Preempt_RT 补丁的性能，我们在内核版本为 5.15.55-generic 的 Intel x86_64 系统上安装了 Ubuntu 22.04，应用了 Preempt_RT 补丁 (patch-5.15.55-rt48.patch.gz)，并优化了表 3。一些视觉模块被修剪🔤

> 啥也没做
> 
***

# 笔记

## 1 论文创新在于

## 2 解决了什么问题

## 3 方法

## 4 不足&可继续研究

## 5 可参考

## 6 思考
