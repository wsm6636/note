---
created: 2023-07-08T20:32
updated: 2024-02-13T22:39
tags:
  - 笔记
  - 笔记/学习笔记
---

# 基础知识

# TSN

## 概念

### 超周期

超周期（Super Cycle）指的是一种在时序网络（TSN）中用于实现周期性流量调度的机制。在TSN网络中，周期性流量通常需要按照固定的时间间隔进行发送，以保证数据传输的可靠性和实时性。**超周期机制允许多个周期性流量在同一时间内进行调度**，从而提高了网络的带宽利用率和数据传输的效率。在超周期机制中，**周期性流量的时间间隔被分为多个相等的时间片，每个时间片称为超周期。==超周期的长度通常是所有周期性流量的最小公倍数==，**以确保所有流量都能够按照固定的时间间隔进行调度。超周期机制通常用于TSN网络中的时隙预定协议（Scheduling Protocol），以保证实时数据传输的效率和可靠性。

### 谐波周期

谐波周期（Harmonic Period），**==每个谐波周期是一个整数倍的原始周期==**。

### 非谐波周期

non-harmonic period，==不是原始周期的整数倍==

### Earliest TxTime First（ETF）

是一种用于时序网络（TSN）中的流量调度算法。ETF算法的原则是==尽可能地提前发送最早到达的数据帧==，以减少网络中的总延迟和抖动，从而提高实时数据传输的效率和可靠性。ETF算法通过对每个数据帧的到达时间和发送时间进行比较，选择最早到达且可以发送的数据帧，将其发送到网络中，从而实现了最小化网络延迟和抖动的目标。ETF算法通常用于TSN网络中的时隙预定协议中，以保证实时数据传输的效率和可靠性。

### travel time

在TSN（时序网络）中，Travel Time指的是从一个节点发送数据到另一个节点的时间，也称为==End-to-End Delay或Latency==。Travel Time是TSN网络中非常重要的性能指标之一，因为它直接影响着实时数据传输的效率和可靠性。在TSN网络中，为了保证实时数据传输的可靠性，需要将Travel Time控制在一定的范围内，以避免数据传输过程中的延迟和抖动。为了实现这一目标，TSN网络中通常会采用时钟同步、流量控制、优先级控制等技术来控制Travel Time。

### 调度流量，非调度流量

**调度流量**通常是指按照预定的时间表和路线进行的网络数据传输服务，例如电子邮件、网页浏览和在线视频等。这些服务通常具有可预测性和稳定性，因为它们按照固定的时间表和路线进行传输，可以进行规划和优化，以提高效率和可靠性。

**非调度流量**则是指根据用户或应用程序的需求**随时**进行的网络数据传输服务，例如即时通讯、文件传输和流媒体等。这些服务通常具有更高的不确定性和不稳定性，因为它们的传输时间和带宽需求随时可能发生变化，需要更加灵活和自适应的网络架构和资源分配方式。

网络的设计和管理需要考虑到这两种类型的流量，以满足不同应用场景和需求的要求。调度流量需要更加稳定和可靠的网络服务，而非调度流量需要更加灵活和高效的网络服务。网络技术的不断发展和创新，旨在为这两种类型的流量提供更加高效和可靠的传输服务。

### 忙周期

在时间敏感网络（Time-Sensitive Networking，TSN）中，busy period是指在某个周期内**所有发送者和接收者都处于忙碌状态的最长时间段**。==在这段时间内，所有数据帧都必须被发送或接收完成==。**如果一个数据帧在busy period结束之前没有被发送或接收完成，那么它就会被视为发送或接收失败。**

busy period是TSN网络中一个非常重要的概念，因为它是保证网络实时性的关键因素之一。**如果busy period太短，那么发送者和接收者可能无法在规定时间内完成数据的传输，从而导致数据丢失或延迟。如果busy period太长，那么网络的资源利用率会下降，从而降低了网络的吞吐量。**

为了确保网络的实时性，TSN网络需要通过调整周期长度、带宽分配、流量控制等方式来控制busy period的长度。网络设计者需要根据实际情况进行参数的优化，以满足实时性和吞吐量的要求。

### Time-Triggered

Time-Triggered是指一种系统设计或通信协议，其中行动或事件是在特定时间触发的，而不是响应外部刺激或用户输入。在Time-Triggered系统中，任务被安排在预定的时间间隔内发生。

==确定的。==

## QBV 时间感知整形TAS

### 定义

#### 关门事件：gate-close event

当与队列相关联的传输门从打开状态转换到关闭状态时发生的事件，将转发过程的传输选择功能**从队列断开**，并**阻止其从该队列中选择帧**。

####  门打开事件：gate-open event

与队列关联的传输门从关闭状态转换到打开状态时发生的事件，将转发进程的传输选择功能**连接到队列**并允许它从该队列中选择帧。

#### 门控周期：gating cycle

门控制列表中的操作序列重复的时间段。

#### 传输门：transmission gate

将转发过程的传输选择功能与队列连接或断开的门，允许或阻止它从该队列中选择帧。门有两种状态，打开和关闭。

每个门操作都会更改与端口的每个流量类别队列相关联的门的传输门状态。在不支持对调度流量进行增强的实现中，假设所有门都永久处于打开状态。

#### 周期定时器状态机

启动门控列表的执行，并确保维持为端口定义的门控周期时间。

####  列表执行状态机

按顺序执行门控制列表中的门操作，并在每个操作之间建立适当的时间延迟。

#### 列表配置状态机

管理更新当前活动调度的过程，在执行更新过程时中断其他两个状态机的操作，并在安装新调度后重新启动它们。

## Qch  循环队列转发CQF

传输时间划分为等长，有编号的时间间隔（i，i+1，i+2），每个间隔持续时间为D

最大延迟（h+1）*d，

最小延迟（h-1）*d，h为跳数

==到达间隔x的帧将在间隔x+1中传输。类似地，到达间隔x+1的帧在间隔x+2中传输，依此类推。==

==先进先出==

**当一个帧通过网络时引入的延迟完全由周期时间和跳数描述，不受任何其他拓扑考虑因素的影响，包括来自其他非时间敏感流量的干扰。**

为了确保达到预期的延迟边界，需要仔细选择**周期时间**、**网络中网桥之间的周期时间对齐**以及**一个周期内第一次和最后一次传输的时间**。

本质上，这种方法涉及到使用两个传输队列和一个周期计时器。在偶数周期（间隔）中，队列1积累从Bridge
接收端口接收到的帧（但不传输这些帧），而队列2传输来自前一个奇数周期的队列帧（并且不接收任何帧）。在奇数周期中，队列2积累从Bridge接收端口接收到的帧（但不传输它们），而队列1发送来自前一个偶数周期的任何排队帧（并且不接收任何帧）。通过适当选择接收和发送周期时间（见T.5），使得对于任何给定流，周期至少足够长，以容纳在流的类测量间隔（见34.6.1，也称为IEEE Std 802.1BA™[B51]中的观测间隔）期间需要在桥接端口上传输的所有时间敏感的流量，再加上一个最大尺寸的干扰帧（或帧片段，如果支持抢占），然后，所有流的流量将在周期时间内在处于接收模式的队列中积累，并将在队列切换到发送模式的周期时间内全部传输。

**此外，CQF有一些限制其生存能力的挑战，例如i)准确地确定适当的周期时间，以及ii)由于处理和传输延迟，帧可能在错误的周期中被接收(即，被放置在错误的出站队列中)的周期持续时间不对齐。**

## 时间同步机制PTP


TSN（Time-Sensitive Networking）实现时间同步的主要方式是采用IEEE 1588协议，也被称为PTP（Precision Time Protocol）。

PTP是一种分布式的时间同步协议，通过在网络中传递时间戳来实现分布式时钟同步。PTP协议中包含了主从模式和对等模式两种方式。在主从模式中，一个设备作为主时钟发送时间戳，其他设备作为从时钟接收时间戳，从而实现时钟同步。在对等模式中，所有设备都可以发送和接收时间戳，相互协作以实现时钟同步。

PTP协议中的时间戳是通过网络中的时间戳消息进行传递的。时间戳消息包含了发送时间和接收时间，接收设备可以通过计算时间戳的差值来计算出发送设备和接收设备的时钟差值，从而实现时钟同步。

除了PTP协议之外，TSN还支持其他的时间同步协议，如SNTP（Simple Network Time Protocol）和NTP（Network Time Protocol）。这些协议也可以用于实现时间同步，但相对于PTP协议来说，它们的精度和可靠性可能会有所降低。

## Offset List
在实时网络中，Offset List是一种用于时间同步的协议，它可以帮助网络中的设备实现高精度的时钟同步。

Offset List协议的基本思想是，通过在网络中传递时间戳消息，计算出每个设备的时钟偏差，并将这些偏差信息保存在一个偏差列表中。这个偏差列表被称为Offset List。

Offset List由主时钟设备维护，主时钟设备会周期性地向网络中发送时间戳消息，其他设备收到消息后，根据消息中的时间戳计算出自己的时钟偏差，并将偏差信息发送回主时钟设备。主时钟设备收集所有设备的时钟偏差信息，并将其保存在Offset List中。

一旦Offset List中收集到足够的时钟偏差信息，主时钟设备就可以利用这些信息来计算出每个设备的时钟偏差，并进行时钟同步。当一个设备需要进行时间同步时，它可以向主时钟设备发送请求，主时钟设备通过Offset List中的信息，计算出该设备的时钟偏差，并将其发送给该设备，从而实现时钟同步。

Offset List协议可以帮助网络中的设备实现高精度的时钟同步，它具有较高的可靠性和可扩展性，可以适用于各种实时网络应用场景。

## Injection Time Planning

是指在TSN网络中确定数据包注入的时间计划，以最大化网络性能和效率。在实时通信应用中，注入时间必须与预定的时间点相匹配，以确保数据包到达目的地的时间准确性和可靠性。

注入时间规划需要考虑以下因素：

1. 发送端缓冲区状态：发送端缓冲区中存放的数据包数量及其优先级。
2. 网络拥塞状态：如果网络出现拥塞，则需要调整注入时间以避免进一步加剧网络拥塞。
3. 时钟同步：所有设备的时钟必须同步，以便数据包到达的时间准确。
4. 数据流要求：不同类型的数据流需要不同的服务质量（QoS）。注入时间计划必须根据不同类型的数据流来优化。
5. 网络拓扑结构：网络拓扑结构对注入时间计划也有重要影响，例如环形网络和星形网络可能需要不同的注入时间策略。

通过考虑上述因素，可以设计出具有高性能和高效率的数据包注入时间计划，从而提高TSN网络的性能和效率。

## buffers respectively

在TSN网络中，缓冲器是用于暂时存储传输数据包的重要组件。不同类型的TNS节点可能会使用不同类型的缓冲器。

1. 发送端缓冲器（Transmit Buffer）：将待发送的数据包存放在此缓冲器中，等待发送机会。发送端缓冲器必须能够根据特定的调度算法从队列中选择出要发送的数据包。
2. 接收端缓冲器（Receive Buffer）：接收到的数据包被存放在这个缓冲器中，等待进一步处理或传递给应用程序。接收端缓冲器必须足够大以容纳可能到达时延较长的数据包。
3. 中间缓冲器（Intermediate Buffer）：在TSN网络中，可能需要在中间节点上进行数据包转发或重新编排。这些中间节点必须具有足够大的中间缓冲器，以便在需要时暂时存储数据包并进行重排序、分段或重新调度。
4. 优先级缓冲器（Priority Buffer）：在TSN网络中，不同类型的数据流需要不同的服务质量。为了满足这些要求，可以使用优先级缓冲器来存储不同优先级的数据包，以确保高优先级数据在低优先级数据之前得到传输。

以上是TSN网络中常见的缓冲器类型。它们在不同的节点和环境中发挥着重要作用，有助于优化网络性能和提高数据传输效率。

## LCM

LCM是Least Common Multiple的缩写，即最小公倍数。在TSN网络中，LCM通常指的是**网络周期**（Network Cycle）。

网络周期是指==所有时隙长度（Time Slot Length）之间的最小公倍数==。在TSN网络中，所有节点必须共享相同的网络周期以确保同步性和协调性。**网络周期必须足够长，以容纳所有节点发送和接收数据包所需的时间。**

网络周期的长度取决于以下因素：

1. 网络拓扑结构：不同的网络拓扑结构需要不同的网络周期长度。
2. 数据流要求：不同类型的数据流需要不同的服务质量（QoS），因此需要根据它们的要求来确定网络周期长度。
3. 发送端缓冲区：发送端缓冲区中存放的数据包数量及其优先级也会影响网络周期的长度。
4. 时钟同步：所有设备的时钟必须同步，以确保网络周期的准确性。

在TSN网络中，LCM是一个重要的概念，因为它直接关系到网络的同步性和性能。通过选择适当的网络周期长度，可以实现高效的数据传输和协同操作。

## GCD

是Greatest Common Divisor的缩写，即最大公约数。在TSN网络中，GCD通常指的是时间槽长度（Time Slot Length）。

时间槽长度是指网络周期（Network Cycle）被分成的等长时间段。在TSN网络中，所有节点必须共享相同的时间槽长度以确保同步性和协调性。时间槽长度越短，网络的响应时间就越快，但对时钟同步的要求也越高。

时间槽长度的选择取决于以下因素：

1. 数据流要求：不同类型的数据流需要不同的服务质量（QoS），因此需要根据它们的要求来确定时间槽长度。
2. 网络拓扑结构：不同的网络拓扑结构需要不同的时间槽长度。
3. 时钟同步：所有设备的时钟必须同步，以确保时间槽的准确性。
4. 发送端缓冲区：发送端缓冲区中存放的数据包数量及其优先级也会影响时间槽长度的选择。

在TSN网络中，GCD是一个重要的概念，因为它直接关系到网络的同步性和性能。通过选择适当的时间槽长度，可以实现高效的数据传输和协同操作。

# TTE

时间触发以太网（Time-Trigger Ethernet，简称TTE），顾名思义，就是具有时间触发（Time-Triggering，简称TT）功能的以太网。

传统以太网则采用“随机争用”的传递方式，当识别到传输通道空闲时，立即触发数据的传输。“事件触发”（Event-Triggering，简称ET）

TT业务的传输由全局系统时间控制，周期性触发。

# 控制

## 稳定时间

在控制理论中，稳定时间是指系统在**输入或设定点发生变化后达到稳定状态所需的时间**。具体而言，它被定义为**系统输出保持在其稳态值的一定百分比（通常为5%）内所需的时间**。

稳定时间是设计和分析控制系统时需要考虑的一个重要参数，因为它会**影响系统的稳定性和性能**。**较长的稳定时间可导致对输入变化的较慢响应**，这在某些应用中可能是不期望的，而较短的稳定时间可以导致更快速和准确的控制。

通常通过观察系统对输入或设定点阶跃变化的响应，然后分析数据以确定输出何时达到规定百分比范围内的稳态值。也可以使用系统的数学模型从理论上对其进行估计。

# 调度

## Sporadic Task偶发任务

偶发任务可以在任何时间调度，至少间隔Pi个时间单位（最小周期），防止偶发任务独占系统资源

如果在请求时间t时，一组进程能够在区间[t,t+d]内的处理器上完全执行c个计算时间单位的进程(c,p,d)。则这组进程是可调度的。

我们用c(t)表示在时间t可运行的进程的剩余计算时间，用d(t)表示当前截止时间，并定义进程在时间t的松弛度为maximum{d(t)-t-c(t),0}，即松弛度是运行时调度程序在必须在当前截止时间之前运行进程之前可以延迟运行该进程的最大时间。



# OS

# 通信

### Guard band

指的是在无线通信系统中，为了防止相邻频道之间的干扰而保留的一段频谱。在无线通信中，不同频段之间的信号可能会相互干扰，因此需要在频段之间留出一定的间隔，即Guard band，来避免干扰。Guard band可以用于降低相邻频段之间的干扰，提高通信系统的性能和可靠性。在一些无线通信标准中，例如LTE（Long-Term Evolution），也会规定一定的Guard band来保证系统性能。

