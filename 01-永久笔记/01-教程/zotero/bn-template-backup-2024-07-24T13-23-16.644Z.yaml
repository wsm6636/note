-
    name: '[QuickInsertV2]'
    text: "<p>\n  <a href=\"${link}\">\n    ${linkText}\n  </a>\n</p>"
-
    name: '[QuickBackLinkV2]'
    text: "<p>\n  Referred in\n  <a href=\"${link}\">\n    ${linkText}\n  </a>\n</p>"
-
    name: '[QuickImportV2]'
    text: "<blockquote>\n${{\n  return await Zotero.BetterNotes.api.convert.link2html(link, {noteItem, dryRun: _env.dryRun});\n}}$\n</blockquote>"
-
    name: '[QuickNoteV5]'
    text: "${{\n  let res = \"\";\n  if (annotationItem.annotationComment) {\n    res += await Zotero.BetterNotes.api.convert.md2html(\n      annotationItem.annotationComment\n    );\n  }\n  res += await Zotero.BetterNotes.api.convert.annotations2html([annotationItem], {noteItem, ignoreComment: true});\n  return res;\n}}$"
-
    name: '[ExportMDFileNameV2]'
    text: '${(noteItem.getNoteTitle ? noteItem.getNoteTitle().replace(/[/\\?%*:|"<> ]/g, "-") + "-" : "")}${noteItem.key}.md'
-
    name: '[ExportMDFileHeaderV2]'
    text: "\n${{\n  let header = {};\n  const tag1 = \",ç¬”è®°/æ–‡çŒ®ç¬”è®°\";\n  const tag2 = \",å¾…å½’æ¡£\";\n  const tag3 = \",ç¬”è®°\";\n  \n  header.tags = noteItem.parentItem.getTags().map((_t) => _t.tag);\n  header.tags += tag1;\n  header.tags += tag2;\n  header.tags += tag3;\n  \n  //const statusname = \"todo\";\n  const statusname = Zotero.getMainWindow().prompt(\"Please input status. todo or ing or done\", \"\");\n  header.status = statusname;\n\n  header.title = noteItem.parentItem\n    ? noteItem.parentItem.getField(\"title\")\n    : \"\";\n\n  header.TitleTranslation = noteItem.parentItem\n    ? noteItem.parentItem.getField(\"titleTranslation\")\n    : \"\";\n\n  header.Pubname = noteItem.parentItem\n    ? noteItem.parentItem.getField(\"conferenceName\")\n\t: \"\";\n  header.Pubname += noteItem.parentItem\n    ? noteItem.parentItem.getField(\"publicationTitle\")\n\t: \"\";\n  header.Pubname += noteItem.parentItem\n    ? noteItem.parentItem.getField(\"university\")\n\t: \"\";\n\n  const firstauthor = noteItem.parentItem.getField(\"firstCreator\");\n  const firstauthor2 = Zotero.getMainWindow().prompt(\"Please input first author.\", firstauthor, \"\");\n  header.FirstAuthor = firstauthor2;\n\n  header.allAuthors = noteItem.parentItem\n    ? noteItem.parentItem.getCreators().map((v)=>v.firstName+\" \"+v.lastName) \n    : \"\";\n\n  const pubdate = noteItem.parentItem.getField(\"date\");\n  const pubdate2 = Zotero.getMainWindow().prompt(\"Please input pubdate.\", pubdate, \"\");\n  header.Pubdate = pubdate2;\n\n  const doi = \"https://doi.org/\";\n  header.DOI = doi\n  header.DOI += noteItem.parentItem\n    ? noteItem.parentItem.getField(\"DOI\")\n    : \"\";\n  \n  const link = \"zotero://select/library/items/\";\n  header.zoterolink = link;\n  header.zoterolink += noteItem.parentItem\n    ? noteItem.parentItem.getField(\"key\")\n    : \"\";\n\n  return JSON.stringify(header);\n}}$\n\n"
-
    name: '[ExportMDFileContent]'
    text: "${{\n  return mdContent;\n}}$"
-
    name: '[Item] item-notes with metadata'
    text: "<h1>${topItem.getField(\"title\")}</h1>\r\n\r\n<p> TitleTranslation: ${topItem.getField('titleTranslation')}</p>\r\n<p> Pubname:${topItem.getField('publicationTitle')}\r\n${topItem.getField('conferenceName')}  ${topItem.getField('university')}</p>\r\n<p> Authors: ${topItem.getCreators().map((v)=>v.firstName+\" \"+v.lastName).join(\"; \")}\r\n    </p>\r\n<p> \r\n\r\n            Pubdate \r\n\r\n            ${topItem.getField('date')}\r\n        \r\n   </p>\r\n<p> \r\n       \r\n            DOI \r\n       \r\n            <a href=\"https://doi.org/${topItem.getField('DOI')}\">${topItem.getField('DOI')}</a>\r\n        \r\n    </p>\r\n\r\n<p>\r\n      æ ‡ç­¾ï¼š#${topItem.getTags().map(tagObj => tagObj.tag).join(', #')}\r\n    </p>\r\n\r\n\r\n<p>  zoterolink:\r\n  <a href=\"${{\r\n  async function getPDFLink(item) {\r\n  \tconst att = await item.getBestAttachment();\r\n  \tif (!att || !att.isPDFAttachment()) {\r\n  \treturn \"\";\r\n  \t}\r\n  \tkey = att.key;\r\n  \tif (att.libraryID === 1) {\r\n  \treturn `zotero://open-pdf/library/items/${key}`;\r\n  \t} else {\r\n  \tgroupID = Zotero.Libraries.get(att.libraryID).id;\r\n  \treturn `zotero://open-pdf/groups/${groupID}/items/${key}`;\r\n  \t}\r\n  }\r\n  sharedObj.getPDFLink = getPDFLink;\r\n  return await getPDFLink(topItem);\r\n  }}$\">\r\n  zotero\r\n  </a></p>\r\n\r\n<h1>æ‘˜è¦</h1>\r\n<p>  ${topItem.getField('abstractTranslation')}</p>\r\n\r\n\r\n\r\n<hr />\r\n<h1>ç¬”è®°</h1>\r\n<h2>1 è®ºæ–‡åˆ›æ–°åœ¨äº</h2>\r\n<h2>2 è§£å†³äº†ä»€ä¹ˆé—®é¢˜</h2>\r\n<h2>3 æ–¹æ³•</h2>\r\n<h2>4 ä¸è¶³&å¯ç»§ç»­ç ”ç©¶</h2>\r\n<h2>5 å¯å‚è€ƒ</h2>\r\n<h2>6 æ€è€ƒ</h2>\r\n\r\n<hr />\r\n\r\n\r\n"
-
    name: '[Item] collect annotations by color'
    text: "${{\r\n    async function getAnnotationsByColor(item, colorFilter) {\r\n      const annots = item.getAnnotations().filter(colorFilter);\r\n  \treturn await Zotero.BetterNotes.api.convert.annotations2html(annots, { noteItem: targetNoteItem });\r\n    }\r\n  \r\n    const attachments = Zotero.Items.get(topItem.getAttachments()).filter((i) =>\r\n      i.isPDFAttachment()\r\n    );\r\n    let res = \"\";\r\n\tconst headname = \"æ³¨é‡Šç¬”è®°-é¢œè‰²\";\r\n    const colors = [\"#ffd400\",\"#ff6666\", \"#5fb236\", \"#2ea8e5\", \"#a28ae5\", \"#e56eee\",\"#f19837\",\"#aaaaaa\",\"#b15928\"];\r\n\tconst colorNames = [\"é—®é¢˜\",\"è´¡çŒ®\", \"æ¨¡å‹\", \"èƒŒæ™¯\", \"ç®—æ³•\", \"å‚è€ƒ\",\"æ–¹æ³•/å®éªŒ\",\"ä¸è¶³\",\"å­¦ä¹ \"];    \r\n\tfor (let attachment of attachments) {\r\n      res += `<h1>${headname}</h1>`;\r\n\t  res += `<h1>${topItem.getField('title')}</h1>`;\r\n      for (let i in colors) {\r\n        const renderedAnnotations = (\r\n          await getAnnotationsByColor(\r\n            attachment,\r\n            (annot) => annot.annotationColor === colors[i]\r\n          )\r\n        );\r\n        if (renderedAnnotations) {\r\n          res += `<h2><p style=\"background-color:${colors[i]};\">${colorNames[i]} Annotations</p></h2>\\n${renderedAnnotations}`;\r\n        }\r\n      }\r\n      const renderedAnnotations = (\r\n        await getAnnotationsByColor(\r\n          attachment,\r\n          (annot) => !colors.includes(annot.annotationColor)\r\n        )\r\n      );\r\n      if (renderedAnnotations) {\r\n        res += `<h2><p>Other Annotations</p></h2>\\n${renderedAnnotations}`;\r\n      }\r\n    }\r\n    return res;\r\n}}$"
-
    name: '[Item] collect annotations by tag'
    text: "  ${{\r\n  \tconst tagRaw = Zotero.getMainWindow().prompt(\"Please input tags. Split with ',':\", \"\");\r\n  \tsharedObj.tags = tagRaw.split(',').filter(t => t.length);\r\n  \treturn \"\";\r\n  }}$\r\n\r\n  ${{\r\n  \tasync function getAnnotationsByTag(item, tag) {\r\n  \t\tlet annots = item.getAnnotations();\r\n  \t\tannots = tag.length ?\r\n  \t\t\tannots.filter((annot) => annot.getTags().map(tagObj => tagObj.tag).includes(tag)) :\r\n  \t\t\tannots;\r\n  \t\treturn await Zotero.BetterNotes.api.convert.annotations2html(annots, { noteItem: targetNoteItem });\r\n  \t}\r\n  \tif (!sharedObj.tags.length) {\r\n  \t\treturn \"\";\r\n  \t}\r\n  \tconst attachments = Zotero.Items.get(topItem.getAttachments()).filter((i) =>\r\n  \t\ti.isPDFAttachment()\r\n  \t);\r\n  \tlet res = \"\";\r\n\tconst headname = \"æ³¨é‡Šç¬”è®°-æ ‡ç­¾\";\r\n  \tres += `<h1>${headname}</h1>`;\r\n\tres += `<h1>${topItem.getField('title')}</h1>`;\r\n  \tfor (let attachment of attachments) {\r\n  \t\t\r\n  \t\tfor (const tag of sharedObj.tags) {\r\n  \t\t\tres += `<h2>Tag: ${tag}</h2>`;\r\n  \t\t\tconst annots = (await getAnnotationsByTag(attachment, tag));\r\n  \t\t\tres += annots ? annots : \"<p>No result</p>\";\r\n  \t\t}\r\n  \t}\r\n  \tres += `<h2>Notes</h2>`;\r\n  \tconst notes = itemNotes.filter(noteItem => {\r\n  \t\tfor (const tag of sharedObj.tags) {\r\n  \t\t\tif (noteItem.getTags().map(tagObj => tagObj.tag).includes(tag)) {\r\n  \t\t\t\treturn true;\r\n  \t\t\t}\r\n  \t\t}\r\n  \t\treturn false;\r\n  \t});\r\n  \tconst notesWithTags = `${notes.map((noteItem) => {\r\n  \t\tconst noteLink = Zotero.BetterNotes.api.convert.note2link(noteItem);\r\n  \t\tconst noteLine = `<p style=\"color:red; background-color: #efe3da;\">ğŸ“œ Article Note:  <a href=\"${\r\n  \t\t\t\tnoteLink\r\n  \t\t\t}\">${noteItem.getNoteTitle() || noteLink}</a></p>\r\n  <p>tags: ${noteItem.getTags().map(tagObj => tagObj.tag).join(', ')}</p>\r\n  <p> </p>`;\r\n  \t\treturn noteLine;\r\n  \t}).join(\"\\n\")}`\r\n  \tres += notesWithTags || '<p>No result</p>'\r\n  \treturn res;\r\n  }}$\r\n  // @default-end"
-
    name: '[Item] Obsidian note'
    text: "<h1>${topItem.getField(\"title\")}</h1>\n\n<h1>æ‘˜è¦</h1>\n<p>  ${topItem.getField('abstractTranslation')}</p>\n\n<hr />\n<h1>ç¬”è®°</h1>\n<h2>1 è®ºæ–‡åˆ›æ–°åœ¨äº</h2>\n<h2>2 è§£å†³äº†ä»€ä¹ˆé—®é¢˜</h2>\n<h2>3 æ–¹æ³•</h2>\n<h2>4 ä¸è¶³&å¯ç»§ç»­ç ”ç©¶</h2>\n<h2>5 å¯å‚è€ƒ</h2>\n<h2>6 æ€è€ƒ</h2>\n\n<hr />"
