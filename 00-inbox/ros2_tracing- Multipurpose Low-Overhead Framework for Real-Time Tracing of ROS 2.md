---
tags: /ing,schedule,ç¬”è®°/æ–‡çŒ®ç¬”è®°,å¾…å½’æ¡£,ç¬”è®°
status: done
title: "ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2"
TitleTranslation: ros2_tracingï¼šç”¨äº ROS 2 å®æ—¶è·Ÿè¸ªçš„å¤šç”¨é€”ä½å¼€é”€æ¡†æ¶
Pubname: IEEE Robotics and Automation Letters
FirstAuthor: Christophe BÃ©dard
allAuthors:
  - Christophe BÃ©dard
  - " Ingo LÃ¼tkebohle"
  - " Michel Dagenais"
Pubdate: 2022-07
DOI: https://doi.org/10.1109/LRA.2022.3174346
zoterolink: zotero://select/library/items/F6IIGQXX
$version: 38987
$libraryID: 1
$itemKey: DVM2A4PB
<<<<<<< HEAD
created: 2024-07-25T16:21
updated: 2024-07-25T16:23
=======
created: 2024-07-24T16:45
updated: 2024-07-24T20:59
>>>>>>> origin/main
---
# ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2

# æ‘˜è¦

ç”±äºé«˜ç³»ç»Ÿå¤æ‚æ€§å’ŒåŠ¨æ€ç¯å¢ƒï¼Œæµ‹è¯•å’Œè°ƒè¯•å·²æˆä¸ºæœºå™¨äººè½¯ä»¶å¼€å‘çš„ä¸»è¦éšœç¢ã€‚æ ‡å‡†çš„ã€åŸºäºä¸­é—´ä»¶çš„æ•°æ®è®°å½•ä¸èƒ½æä¾›æœ‰å…³å†…éƒ¨è®¡ç®—å’Œæ€§èƒ½ç“¶é¢ˆçš„è¶³å¤Ÿä¿¡æ¯ã€‚å…¶ä»–ç°æœ‰æ–¹æ³•ä¹Ÿé’ˆå¯¹éå¸¸å…·ä½“çš„é—®é¢˜ï¼Œå› æ­¤ä¸èƒ½ç”¨äºå¤šç”¨é€”åˆ†æã€‚æ­¤å¤–ï¼Œå®ƒä»¬ä¸é€‚åˆå®æ—¶åº”ç”¨ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† ros2\_tracingï¼Œå®ƒæ˜¯ ROS 2 çš„çµæ´»è·Ÿè¸ªå·¥å…·å’Œå¤šç”¨é€”ä»ªå™¨çš„é›†åˆã€‚å®ƒå…è®¸ä½¿ç”¨ä½å¼€é”€çš„ LTTng è·Ÿè¸ªå™¨æ”¶é›†å®æ—¶åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šçš„è¿è¡Œæ—¶æ‰§è¡Œä¿¡æ¯ã€‚å·¥å…·è¿˜å°†è·Ÿè¸ªé›†æˆåˆ°å®è´µçš„ ROS 2 ç¼–æ’ç³»ç»Ÿå’Œå…¶ä»–å¯ç”¨æ€§å·¥å…·ä¸­ã€‚æ¶ˆæ¯å»¶è¿Ÿå®éªŒè¡¨æ˜ï¼Œå¯ç”¨æ‰€æœ‰ ROS 2 å·¥å…·æ—¶ï¼Œç«¯åˆ°ç«¯æ¶ˆæ¯å»¶è¿Ÿå¼€é”€å¹³å‡ä¸º 0.0033 æ¯«ç§’ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™é€‚åˆç”Ÿäº§å®æ—¶ç³»ç»Ÿã€‚ä½¿ç”¨ ros2\_tracing è·å¾—çš„ ROS 2 æ‰§è¡Œä¿¡æ¯å¯ä»¥ä¸æ¥è‡ªæ“ä½œç³»ç»Ÿçš„è·Ÿè¸ªæ•°æ®ç›¸ç»“åˆï¼Œä»è€Œå®ç°æ›´å¹¿æ³›çš„ç²¾ç¡®åˆ†æï¼Œæœ‰åŠ©äºäº†è§£åº”ç”¨ç¨‹åºçš„æ‰§è¡Œæƒ…å†µï¼Œæ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆå’Œå…¶ä»–é—®é¢˜çš„åŸå› ã€‚æºä»£ç ä½äºï¼šhttps\://github.com/ros2/ros2tracingã€‚

# \[color]ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2

## <span style="background-color: #ff666680">è´¡çŒ®/ç»“æœ Annotations</span>

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22R77P9GRA%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B332%2C143.193%2C563.033%2C151.831%5D%2C%5B332%2C131.238%2C563.033%2C139.876%5D%2C%5B332%2C119.283%2C361.938%2C127.921%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%221%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=1&#x26;annotation=R77P9GRA">â€œIt offers extensible tracing instrumentation capable of providing execution information on multiple facets of ROS 2.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%221%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 1</a></span>)</span> ğŸ”¤å®ƒæä¾›å¯æ‰©å±•çš„è·Ÿè¸ªå·¥å…·ï¼Œèƒ½å¤Ÿæä¾› ROS 2 å¤šä¸ªæ–¹é¢çš„æ‰§è¡Œä¿¡æ¯ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22BAASK8VJ%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%221%22%2C%22position%22%3A%7B%22pageIndex%22%3A0%2C%22rects%22%3A%5B%5B332%2C107.327%2C563.033%2C115.965%5D%2C%5B332%2C95.372%2C563.033%2C104.01%5D%2C%5B332%2C83.417%2C563.033%2C92.055%5D%2C%5B332%2C71.462%2C517.533%2C80.1%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%221%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=1&#x26;annotation=BAASK8VJ">â€œWith a strategic two-phase instrumentation design and using a low-overhead tracer, it has a lower runtime overhead than current solutions, making it suitable for the real-time applications targeted by ROS 2.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%221%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 1</a></span>)</span> ğŸ”¤å®ƒé‡‡ç”¨æˆ˜ç•¥æ€§ä¸¤é˜¶æ®µä»ªå™¨è®¾è®¡å¹¶ä½¿ç”¨ä½å¼€é”€è·Ÿè¸ªå™¨ï¼Œå…¶è¿è¡Œæ—¶å¼€é”€æ¯”å½“å‰è§£å†³æ–¹æ¡ˆæ›´ä½ï¼Œä½¿å…¶é€‚åˆ ROS 2 æ‰€é’ˆå¯¹çš„å®æ—¶åº”ç”¨ç¨‹åºã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22UADJK2MD%22%2C%22color%22%3A%22%23ff6666%22%2C%22pageLabel%22%3A%222%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B68.986%2C725.41%2C249.588%2C734.048%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=2&#x26;annotation=UADJK2MD">â€œuserspace and kernel space data as a whole.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 2</a></span>)</span> ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚\
ğŸ”¤ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚ğŸ”¤

## <span style="background-color: #5fb23680">æ¨¡å‹ Annotations</span>

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22LKAE55PE%22%2C%22color%22%3A%22%235fb236%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B58.927%2C103.741%2C300.022%2C112.379%5D%2C%5B48.964%2C91.786%2C300.022%2C100.424%5D%2C%5B48.964%2C79.831%2C300.022%2C88.469%5D%2C%5B48.964%2C67.875%2C300.022%2C76.513%5D%2C%5B48.964%2C55.92%2C300.022%2C64.558%5D%2C%5B48.964%2C43.965%2C128.197%2C52.603%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%223%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=3&#x26;annotation=LKAE55PE">â€œAs shown in Fig. 2, core ROS 2 packages are instrumented with function calls to the tracetools package. This package provides tracepoints for all of ROS 2 and is the one that triggers them. Tracepoints usually act as instrumentation points and could be directly added to the instrumented code.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%223%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 3</a></span>)</span> ğŸ”¤å¦‚å›¾ 2 æ‰€ç¤ºï¼Œæ ¸å¿ƒ ROS 2 åŒ…é€šè¿‡å¯¹ Tracetools åŒ…çš„å‡½æ•°è°ƒç”¨è¿›è¡Œæ£€æµ‹ã€‚è¯¥è½¯ä»¶åŒ…ä¸ºæ‰€æœ‰ ROS 2 æä¾›è·Ÿè¸ªç‚¹ï¼Œå¹¶ä¸”æ˜¯è§¦å‘å®ƒä»¬çš„è·Ÿè¸ªç‚¹ã€‚è·Ÿè¸ªç‚¹é€šå¸¸å……å½“æ£€æµ‹ç‚¹ï¼Œå¯ä»¥ç›´æ¥æ·»åŠ åˆ°æ£€æµ‹ä»£ç ä¸­ã€‚ğŸ”¤

## <span style="background-color: #2ea8e580">èƒŒæ™¯ Annotations</span>

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22XWIZG98W%22%2C%22color%22%3A%22%232ea8e5%22%2C%22pageLabel%22%3A%222%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B311.978%2C299.636%2C563.036%2C308.274%5D%2C%5B311.978%2C287.681%2C423.988%2C296.319%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=2&#x26;annotation=XWIZG98W">â€œAs of ROS 2 Galactic Geochelone, the default middleware is Eclipse Cyclone DDS [24].â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 2</a></span>)</span> ğŸ”¤ä» ROS 2 Gactic Geochelone å¼€å§‹ï¼Œé»˜è®¤ä¸­é—´ä»¶æ˜¯ Eclipse Cyclone DDS \[24]ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22HM4JKDLX%22%2C%22color%22%3A%22%232ea8e5%22%2C%22pageLabel%22%3A%222%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B321.94%2C67.875%2C563.035%2C76.513%5D%2C%5B311.978%2C55.92%2C563.036%2C64.558%5D%2C%5B311.978%2C43.964%2C563.036%2C52.602%5D%5D%2C%22nextPageRects%22%3A%5B%5B48.964%2C725.4100784%2C300.02152%2C734.0476526%5D%2C%5B48.964%2C713.4540784%2C300.0215200000001%2C722.0916526%5D%2C%5B48.964%2C701.4990783999999%2C300.02152%2C710.1366525999999%5D%2C%5B48.964%2C689.5440783999999%2C300.0215200000001%2C698.1816525999999%5D%2C%5B48.964%2C677.5890783999998%2C300.02152%2C686.2266525999999%5D%2C%5B48.964%2C665.6340783999998%2C258.68669260000013%2C674.2716525999998%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=2&#x26;annotation=HM4JKDLX">â€œAs for the code, in ROS, it is generally split into multiple packages, which directly and indirectly depend on other packages. Each package has a specific purpose and may provide multiple libraries and executables, with each executable containing any number of nodes. The ROS ecosystem is federated: packages are spread across multiple code repositories, on various hosts, and are authored and maintained by different people. The ROS 2 source code itself is made up of multiple packages that approximately match its architecture.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%222%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 2</a></span>)</span> ğŸ”¤è‡³äºä»£ç ï¼Œåœ¨ROSä¸­ï¼Œä¸€èˆ¬ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ªåŒ…ï¼Œè¿™äº›åŒ…ç›´æ¥æˆ–é—´æ¥ä¾èµ–äºå…¶ä»–åŒ…ã€‚æ¯ä¸ªåŒ…éƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ï¼Œå¹¶ä¸”å¯ä»¥æä¾›å¤šä¸ªåº“å’Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶åŒ…å«ä»»æ„æ•°é‡çš„èŠ‚ç‚¹ã€‚ ROS ç”Ÿæ€ç³»ç»Ÿæ˜¯è”åˆçš„ï¼šåŒ…åˆ†å¸ƒåœ¨å¤šä¸ªä»£ç å­˜å‚¨åº“ã€ä¸åŒçš„ä¸»æœºä¸Šï¼Œå¹¶ç”±ä¸åŒçš„äººç¼–å†™å’Œç»´æŠ¤ã€‚ ROS 2 æºä»£ç æœ¬èº«ç”±å¤šä¸ªä¸å…¶æ¶æ„å¤§è‡´åŒ¹é…çš„åŒ…ç»„æˆã€‚ğŸ”¤

## <span style="background-color: #e56eee80">å‚è€ƒ/å­¦ä¹  Annotations</span>

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22H5P6Q64Y%22%2C%22color%22%3A%22%23e56eee%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B110.304%2C573.853%2C300.022%2C582.491%5D%2C%5B48.964%2C561.897%2C300.022%2C570.535%5D%2C%5B48.964%2C549.942%2C300.022%2C558.58%5D%2C%5B48.964%2C537.987%2C300.022%2C546.625%5D%2C%5B48.964%2C526.032%2C300.022%2C534.67%5D%2C%5B48.964%2C514.077%2C300.022%2C522.715%5D%2C%5B48.964%2C502.122%2C300.022%2C510.76%5D%2C%5B48.964%2C490.166%2C300.022%2C498.804%5D%2C%5B48.964%2C478.211%2C300.027%2C486.849%5D%2C%5B48.964%2C466.256%2C177.79%2C474.894%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=5&#x26;annotation=H5P6Q64Y">â€œFor example, we traced a ROS 2 system that simulates a real-world autonomous driving scenario [27]. In this example, a node receives data from 6 different topics using subscriptions. When the subscriptions receive a new message, they cache it so that the node only keeps the latest message for each topic. The periodically-triggered callback uses the latest message from each topic to compute a result and publish it. To analyze the trace data, we wrote a simple script using tracetools_analysis [28], a Python library to read and analyze trace data.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 5</a></span>)</span> ğŸ”¤ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¿½è¸ªäº†ä¸€ä¸ªæ¨¡æ‹Ÿç°å®ä¸–ç•Œè‡ªåŠ¨é©¾é©¶åœºæ™¯çš„ ROS 2 ç³»ç»Ÿ \[27]ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒèŠ‚ç‚¹ä½¿ç”¨è®¢é˜…ä» 6 ä¸ªä¸åŒä¸»é¢˜æ¥æ”¶æ•°æ®ã€‚å½“è®¢é˜…æ”¶åˆ°æ–°æ¶ˆæ¯æ—¶ï¼Œå®ƒä»¬ä¼šå°†å…¶ç¼“å­˜ï¼Œä»¥ä¾¿èŠ‚ç‚¹ä»…ä¿ç•™æ¯ä¸ªä¸»é¢˜çš„æœ€æ–°æ¶ˆæ¯ã€‚å®šæœŸè§¦å‘çš„å›è°ƒä½¿ç”¨æ¯ä¸ªä¸»é¢˜çš„æœ€æ–°æ¶ˆæ¯æ¥è®¡ç®—ç»“æœå¹¶å°†å…¶å‘å¸ƒã€‚ä¸ºäº†åˆ†æè·Ÿè¸ªæ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨tracetools\_analysis \[28]ï¼ˆä¸€ä¸ªç”¨äºè¯»å–å’Œåˆ†æè·Ÿè¸ªæ•°æ®çš„Python åº“ï¼‰ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è„šæœ¬ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22B8GBYHKC%22%2C%22color%22%3A%22%23e56eee%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B311.978%2C175.472%2C563.036%2C184.11%5D%2C%5B311.978%2C163.517%2C563.036%2C172.155%5D%2C%5B311.978%2C151.561%2C563.036%2C160.199%5D%2C%5B311.978%2C139.606%2C563.036%2C148.244%5D%2C%5B311.978%2C127.651%2C563.036%2C136.289%5D%2C%5B311.978%2C115.696%2C379.006%2C124.334%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=5&#x26;annotation=B8GBYHKC">â€œIn this example, a multi-threaded executor was used, with the number of threads being equal to the number of logical CPU cores by default. Since this was not the only application running on the system at that time, multiple processes and threads were competing for CPU, as can be observed using Trace Compass.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 5</a></span>)</span> ğŸ”¤æœ¬ä¾‹ä¸­ä½¿ç”¨äº†å¤šçº¿ç¨‹æ‰§è¡Œå™¨ï¼Œé»˜è®¤çº¿ç¨‹æ•°ç­‰äºé€»è¾‘CPUæ ¸å¿ƒæ•°ã€‚ç”±äºè¿™ä¸æ˜¯å½“æ—¶ç³»ç»Ÿä¸Šè¿è¡Œçš„å”¯ä¸€åº”ç”¨ç¨‹åºï¼Œå› æ­¤å¤šä¸ªè¿›ç¨‹å’Œçº¿ç¨‹æ­£åœ¨ç«äº‰ CPUï¼Œè¿™ä¸€ç‚¹å¯ä»¥ä½¿ç”¨ Trace Compass è§‚å¯Ÿåˆ°ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%225YN9HVS2%22%2C%22color%22%3A%22%23e56eee%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B58.927%2C460.601%2C300.027%2C469.239%5D%2C%5B48.964%2C448.645%2C300.022%2C457.283%5D%2C%5B48.964%2C436.69%2C300.022%2C445.328%5D%2C%5B48.964%2C424.735%2C300.022%2C433.373%5D%2C%5B48.964%2C412.78%2C300.022%2C421.418%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=6&#x26;annotation=5YN9HVS2">â€œSince the ros2_tracing tracepoints are placed along the message publication and reception pipeline, an easy way to capture the maximum overhead is to measure the time between publishing a message and when it is handled by the subscription callback. This is what we will do in the following.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 6</a></span>)</span> ğŸ”¤ç”±äº ros2\_tracing è·Ÿè¸ªç‚¹æ²¿ç€æ¶ˆæ¯å‘å¸ƒå’Œæ¥æ”¶ç®¡é“æ”¾ç½®ï¼Œæ•è·æœ€å¤§å¼€é”€çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯æµ‹é‡å‘å¸ƒæ¶ˆæ¯å’Œè®¢é˜…å›è°ƒå¤„ç†æ¶ˆæ¯ä¹‹é—´çš„æ—¶é—´ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…ã€‚ğŸ”¤

## <span style="background-color: #f1983780">æ–¹æ³•/å®éªŒ Annotations</span>

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22V5PYT6WW%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B338.71%2C537.048%2C563.036%2C543.959%5D%2C%5B311.978%2C528.082%2C563.036%2C534.993%5D%2C%5B311.978%2C519.116%2C473.986%2C526.027%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=5&#x26;annotation=V5PYT6WW">â€œExample timer callback execution interval (top) and duration (bottom) over time. The callback period is set to 100 ms, while the callback duration depends on the work done. Both contain outliers.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 5</a></span>)</span> ğŸ”¤éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè®¡æ—¶å™¨å›è°ƒæ‰§è¡Œé—´éš”ï¼ˆé¡¶éƒ¨ï¼‰å’ŒæŒç»­æ—¶é—´ï¼ˆåº•éƒ¨ï¼‰ç¤ºä¾‹ã€‚å›è°ƒå‘¨æœŸè®¾ç½®ä¸º 100 æ¯«ç§’ï¼Œå›è°ƒæŒç»­æ—¶é—´å–å†³äºå®Œæˆçš„å·¥ä½œã€‚ä¸¤è€…éƒ½åŒ…å«å¼‚å¸¸å€¼ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22Z7HH2KS4%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B514.229%2C426.53%2C563.036%2C435.168%5D%2C%5B311.978%2C414.575%2C563.036%2C423.213%5D%2C%5B311.978%2C402.62%2C563.036%2C411.258%5D%2C%5B311.978%2C390.665%2C563.036%2C399.303%5D%2C%5B311.978%2C378.71%2C563.036%2C387.348%5D%2C%5B311.978%2C366.755%2C563.036%2C375.393%5D%2C%5B311.978%2C354.799%2C563.036%2C363.437%5D%2C%5B311.978%2C342.844%2C563.036%2C351.482%5D%2C%5B311.978%2C330.889%2C404.999%2C339.527%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=5&#x26;annotation=Z7HH2KS4">â€œThe ROS 2 trace data that was obtained using the ros2_tracing instrumentation can be analyzed together with the OS trace data using Eclipse Trace Compass [29], which is an open-source trace viewer and framework aimed towards performance and reliability analysis. Trace Compass can analyze Linux kernel data to show the frequency and state of CPUs over time, including interrupts, system calls, or userspace processes executing on each CPU.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 5</a></span>)</span> ğŸ”¤ä½¿ç”¨ ros2\_tracing ä»ªå™¨è·å¾—çš„ ROS 2 è·Ÿè¸ªæ•°æ®å¯ä»¥ä½¿ç”¨ Eclipse Trace Compass \[29] ä¸æ“ä½œç³»ç»Ÿè·Ÿè¸ªæ•°æ®ä¸€èµ·è¿›è¡Œåˆ†æï¼ŒEclipse Trace Compass æ˜¯ä¸€ä¸ªå¼€æºè·Ÿè¸ªæŸ¥çœ‹å™¨å’Œæ¡†æ¶ï¼Œæ—¨åœ¨è¿›è¡Œæ€§èƒ½å’Œå¯é æ€§åˆ†æã€‚ Trace Compass å¯ä»¥åˆ†æ Linux å†…æ ¸æ•°æ®ï¼Œä»¥æ˜¾ç¤º CPU éšæ—¶é—´å˜åŒ–çš„é¢‘ç‡å’ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸­æ–­ã€ç³»ç»Ÿè°ƒç”¨æˆ–æ¯ä¸ª CPU ä¸Šæ‰§è¡Œçš„ç”¨æˆ·ç©ºé—´è¿›ç¨‹ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%225P6AQQPM%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B377.761%2C247.203%2C563.036%2C255.841%5D%2C%5B311.978%2C235.248%2C563.036%2C243.886%5D%2C%5B311.978%2C223.292%2C563.036%2C231.93%5D%2C%5B311.978%2C211.337%2C563.036%2C219.975%5D%2C%5B311.978%2C199.382%2C563.036%2C208.02%5D%2C%5B311.978%2C187.427%2C563.036%2C196.065%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=5&#x26;annotation=5P6AQQPM">â€œFinding the timestamps of the corresponding ROS 2 events in Trace Compass, we see that the thread was blocked waiting for CPU for 9.9 ms before the aforementioned callback instance. The thread then had to query the middleware for new messages (even if timers are strictly handled at the ROS 2 level) and finally call the overdue timer callback.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 5</a></span>)</span> ğŸ”¤åœ¨ Trace Compass ä¸­æŸ¥æ‰¾ç›¸åº” ROS 2 äº‹ä»¶çš„æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬å‘ç°çº¿ç¨‹åœ¨ä¸Šè¿°å›è°ƒå®ä¾‹ä¹‹å‰è¢«é˜»å¡ç­‰å¾… CPU 9.9 æ¯«ç§’ã€‚ç„¶åï¼Œçº¿ç¨‹å¿…é¡»å‘ä¸­é—´ä»¶æŸ¥è¯¢æ–°æ¶ˆæ¯ï¼ˆå³ä½¿è®¡æ—¶å™¨ä¸¥æ ¼åœ¨ ROS 2 çº§åˆ«å¤„ç†ï¼‰ï¼Œæœ€åè°ƒç”¨é€¾æœŸè®¡æ—¶å™¨å›è°ƒã€‚ğŸ”¤

![image.png](https://raw.githubusercontent.com/wsm6636/pic/main/202407251623009.png)

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%226LM54I5I%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B76.572%2C671.156%2C563.036%2C678.067%5D%2C%5B48.964%2C662.031%2C563.039%2C669.853%5D%2C%5B48.964%2C653.065%2C563.036%2C660.887%5D%2C%5B48.964%2C644.256%2C563.035%2C651.167%5D%2C%5B48.964%2C635.132%2C563.035%2C642.954%5D%2C%5B48.964%2C626.324%2C116.734%2C633.235%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=6&#x26;annotation=6LM54I5I">â€œState of ROS 2 application threads over time with timestamps of ROS 2 events from the ros2_tracing instrumentation displayed as small triangles on top of the thread state rectangle: Â©1 thread waiting for CPU for 9.9 ms (orange), Â©2 thread running (green), Â©3 event marking start of middleware query &#x26; wait for new messages, Â©4 event marking end of middleware query, and Â©5 rclcpp_executor_execute event followed shortly after by callback_start event for timer callback. This result was obtained by importing trace data collected from the Linux kernel and from the ROS 2 application using LTTng into Trace Compass [29]. The black arrow to the left of 3Â© represents the scheduling switch from one thread to another for a given CPU. Some less relevant threads were hidden.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 6</a></span>)</span> ğŸ”¤ROS 2 åº”ç”¨ç¨‹åºçº¿ç¨‹éšæ—¶é—´çš„çŠ¶æ€ï¼Œä»¥åŠæ¥è‡ª ros2\_tracing æ£€æµ‹çš„ ROS 2 äº‹ä»¶çš„æ—¶é—´æˆ³ï¼Œåœ¨çº¿ç¨‹çŠ¶æ€çŸ©å½¢é¡¶éƒ¨æ˜¾ç¤ºä¸ºå°ä¸‰è§’å½¢ï¼šÂ©1 çº¿ç¨‹ç­‰å¾… CPU 9.9 æ¯«ç§’ï¼ˆæ©™è‰²ï¼‰ï¼ŒÂ©2 çº¿ç¨‹æ­£åœ¨è¿è¡Œï¼ˆç»¿è‰²ï¼‰ ï¼ŒÂ©3 äº‹ä»¶æ ‡è®°ä¸­é—´ä»¶æŸ¥è¯¢å¼€å§‹å¹¶ç­‰å¾…æ–°æ¶ˆæ¯ï¼ŒÂ©4 äº‹ä»¶æ ‡è®°ä¸­é—´ä»¶æŸ¥è¯¢ç»“æŸï¼Œä»¥åŠÂ©5 rclcpp\_executor\_execute äº‹ä»¶ï¼Œç´§éšå…¶åçš„æ˜¯ç”¨äºè®¡æ—¶å™¨å›è°ƒçš„callback\_start äº‹ä»¶ã€‚è¯¥ç»“æœæ˜¯é€šè¿‡ä½¿ç”¨ LTTng å°†ä» Linux å†…æ ¸å’Œ ROS 2 åº”ç”¨ç¨‹åºæ”¶é›†çš„è·Ÿè¸ªæ•°æ®å¯¼å…¥åˆ° Trace Compass \[29] ä¸­è·å¾—çš„ã€‚ 3Â© å·¦ä¾§çš„é»‘è‰²ç®­å¤´è¡¨ç¤ºç»™å®š CPU ä»ä¸€ä¸ªçº¿ç¨‹åˆ°å¦ä¸€ä¸ªçº¿ç¨‹çš„è°ƒåº¦åˆ‡æ¢ã€‚ä¸€äº›ä¸å¤ªç›¸å…³çš„çº¿ç¨‹è¢«éšè—äº†ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22TH6DQHFV%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B58.927%2C199.382%2C300.022%2C208.02%5D%2C%5B48.964%2C187.427%2C300.022%2C196.065%5D%2C%5B48.964%2C175.472%2C300.022%2C184.11%5D%2C%5B48.964%2C163.517%2C300.022%2C172.155%5D%2C%5B48.964%2C151.562%2C244.261%2C160.2%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=6&#x26;annotation=TH6DQHFV">â€œTo reduce measurement variability, we follow common practice by using a kernel patched with the PREEMPT RT patch (5.4.3-rt1), disabling simultaneous multithreading, and disabling power-saving features in the BIOS (dynamic frequency scaling, C-states, Turbo Boost, etc.).â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 6</a></span>)</span> ğŸ”¤ä¸ºäº†å‡å°‘æµ‹é‡å˜å¼‚æ€§ï¼Œæˆ‘ä»¬éµå¾ªå¸¸è§åšæ³•ï¼Œä½¿ç”¨ç”¨ PREEMPT RT è¡¥ä¸ (5.4.3-rt1) ä¿®è¡¥çš„å†…æ ¸ï¼Œç¦ç”¨åŒæ—¶å¤šçº¿ç¨‹ï¼Œå¹¶ç¦ç”¨ BIOS ä¸­çš„çœç”µåŠŸèƒ½ï¼ˆåŠ¨æ€é¢‘ç‡ç¼©æ”¾ã€C çŠ¶æ€ã€Turboï¼‰å‡å‹ç­‰ï¼‰ã€‚ğŸ”¤

<span class="highlight" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FU68SQLMG%22%2C%22annotationKey%22%3A%22QY8WGCZL%22%2C%22color%22%3A%22%23f19837%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B483.345%2C583.341%2C525.706%2C591.979%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%7D" ztype="zhighlight"><a href="zotero://open-pdf/library/items/U68SQLMG?page=6&#x26;annotation=QY8WGCZL">â€œFast DDS.â€</a></span> <span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8765952%2Fitems%2FF6IIGQXX%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/F6IIGQXX">BÃ©dard ç­‰, 2022, p. 6</a></span>)</span> ğŸ”¤å¿«é€Ÿ DDSã€‚ğŸ”¤

# ç¬”è®°

## 1 è®ºæ–‡åˆ›æ–°åœ¨äº

## 2 è§£å†³äº†ä»€ä¹ˆé—®é¢˜

## 3 æ–¹æ³•

## 4 ä¸è¶³&å¯ç»§ç»­ç ”ç©¶

## 5 å¯å‚è€ƒ

## 6 æ€è€ƒ
