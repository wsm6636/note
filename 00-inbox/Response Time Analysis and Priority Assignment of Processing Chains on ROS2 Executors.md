---
created: 2024-03-27T18:55
updated: 2024-05-16T11:35
tags:
  - 笔记
  - 笔记/文献笔记
  - 待归档
status:
  - todo
---
# Response Time Analysis and Priority Assignment of Processing Chains on ROS2 Executors
 



**TitleTranslation:**  ROS2执行器处理链的响应时间分析和优先级分配
**Journal or Conference:**   2020 IEEE Real-Time Systems Symposium (RTSS)  
**Authors:**  YueTang, ZhiweiFeng, NanGuan, XuJiang, MingsongLv, QingxuDeng, WangYi
**Pub.date:**  2020-12
**DOI:**  10.1109/RTSS49844.2020.00030
**tags:** #/ing, schedule
**zoterolink:**  [zotero](zotero://select/library/items/LNS5SD3S)

# 摘要

ROS（机器人操作系统）是目前最流行的机器人软件开发框架。安全关键领域的机器人软件通常受到硬实时约束，因此设计人员必须对其时序行为进行正式建模和分析，以确保在运行时始终遵守实时约束。本文研究了ROS2中处理链的实时调度和分析，ROS2是第二代ROS，主要考虑实时性。首先，我们研究 ROS2 执行器上处理链的响应时间分析。我们证明这个问题唯一存在的结果是乐观和悲观的，并开发新技术来解决这些问题并显着提高分析精度。其次，我们揭示了执行器上处理链的响应时间仅取决于其最后的调度实体（回调），这为设计人员提供了有用的指导，不仅可以改善响应时间界限，还可以改善实际的最坏情况/平均值以很少的设计成本实现系统的响应时间。我们使用随机生成的工作负载进行实验，并在现实的 ROS2 平台上进行案例研究，以评估和演示我们的结果。

# 一、简介
ROS（机器人操作系统）[1]是目前最流行的机器人软件开发框架和事实上的标准。自 2010 年发布 1.0 版本以来，ROS 已被工业界和学术界数十万开发人员和研究人员使用，为大量不同类型的机器人系统提供支持 [2]、[3]。 ROS 的一个主要理念是通过促进软件模块化和可组合性来提高机器人软件开发的生产力，但这也导致了一些根本性的缺点。一个主要缺点是缺乏实时能力，这限制了 ROS 的更广泛传播，因为机器人中的计算通常受到时间限制 [4]。

ROS2 [5]是自2017年以来发布的第二代ROS，继承了ROS的成功理念，并将其置于改进的基础上[6]。 ROS2的一个主要考虑因素是支持强大的实时能力。例如，ROS2采用DDS（数据分发服务）[7]作为进程间通信中间件进行实时数据交换，可以部署在实时操作系统之上（而不是仅运行在Linux上）并支持实时操作系统。面向控制的代码路径上的时间安全资源预分配。

ROS2的新架构提供了良好的基础，但其本身不足以支持硬实时机器人软件。对于硬实时系统，设计人员必须验证系统时序属性并保证在运行时的任何情况下都遵守时序约束。最近，卡西尼等人[6] 在 ROS2 中处理器调度的形式化建模和分析方面进行了开创性工作。特别是，[6]对 ROS2 执行器（ROS2 多路复用计算任务的核心组件）中的工作负载结构和调度策略进行了建模，并开发了限制 ROS2 执行器上处理链响应时间上限的技术。事实证明，ROS2执行器的调度行为与过去实时调度研究中研究的行为有很大不同，需要新的分析技术。 [6]的高层愿景和具体成果对ROS社区[8]、[9]产生了直接影响，并有可能引发实时调度和ROS社区之间更密切的互动，以支持分析硬实时保证ROS2。

尽管其意义重大，<span style="background:#fff88f">[6]中的工作也存在一些问题：ROS2执行器上的处理链（在[6]中称为子链）的响应时间界限既是乐观的（界限可能小于实际最坏情况）又是悲观的（该界限通常不必要地大于实际最坏情况）。我们将在第四节详细讨论这些问题。</span>

本文的第一个贡献是通过开发用于 ROS2 执行器上的处理链的新响应时间分析技术来解决[6]中的上述问题。我们的新分析技术通过探索对 ROS2 执行器调度行为的深入了解，显着提高了分析精度。对随机生成的工作负载进行的实证评估表明，我们的<span style="background:#ff4d4f">新响应时间界限始终优于[6]</span>，在不同的参数设置下具有显着的优势。

应用程序开发人员提高系统响应能力，不仅是硬实时系统的响应时间上限，而且是软实时和通用系统的实际最坏情况和平均响应时间，几乎不需要甚至不需要额外的设计成本。我们使用随机生成工作负载的模拟实验和基于 ROS2 的真实机器人软件系统的案例研究来演示我们的发现的用途。

我们的第二个贡献是<span style="background:#ff4d4f">研究回调优先级分配如何影响 ROS2 执行器上处理链的响应时间</span>，据我们所知，在之前的工作中尚未解决这个问题。我们发现<span style="background:#ff4d4f">处理链的响应时间仅取决于该处理链中最后一个回调的优先级：分配给最后一个回调的优先级越高，处理链的响应时间可能越短。</span>这个属性可以帮助ROS2应用程序开发人员提高系统响应能力，不仅是硬实时系统的响应时间上限，而且是软实时和一般系统的实际最坏情况和平均响应时间，几乎没有或甚至没有额外的设计成本。我们使用随机生成工作负载的模拟实验和基于 ROS2 的真实机器人软件系统的案例研究来演示我们的发现的用途。

# 二.相关工作
学术研究界意识到ROS缺乏实时能力，并致力于这方面的改进。 [10]将优先级机制引入ROS的调度和数据交换，[11]在实时操作系统上运行ROS的实时节点以获得更好的实时性能。 [12]提出了一种实时调度框架，[13]提出了基于透明CPU/GPU协调机制的实时ROS扩展。然而，这些研究仅提高了系统的实时能力，并没有提供任何分析实时性保证。对于ROS2，[14]、[15]通过实验评估了不同底层实时操作系统和不同DDS实现的ROS2的性能，这些都是基于测量的，但没有考虑形式化建模和分析。

据我们所知，现有的唯一关于 ROS2 执行器时序行为的形式化建模和分析的工作是 [6]。然而，如上所述，[6]中处理链的响应时间分析既乐观又悲观。我们的工作通过探索对 ROS2 执行器调度行为的更深入了解并开发新的分析技术来解决这些问题。此外，我们研究了回调优先级分配对处理链响应时间的影响，这在[6]中没有考虑。

基于链的任务模型的时序分析的实时调度研究已经做了很多工作，根据任务的激活方法可以将其分为两类[16]：触发链[17]-[21]，其中前置任务触发后继任务的释放，以及数据链[16]、[22]-[25]，其中任务被单独触发，因此可能发生过采样或欠采样。从广义上讲，本文考虑的ROS2执行器上的处理链属于触发链范畴。然而，ROS2 执行器的调度行为与之前工作中研究的调度行为显着不同，并且没有现有的分析技术适用于我们的问题。

# 三．系统模型
本节介绍系统模型。我们首先提供一些关于 ROS2 的简要背景和我们的系统模型的背景（ROS2 的更详细介绍可以在 [6] 中找到）。图1-(a)显示了ROS2的架构。 <span style="background:#40a9ff">ROS2 应用程序通常由单个节点组成，这些节点使用发布订阅范例相互通信：节点发布有关主题的消息，主题将消息广播到订阅该主题的节点。节点通过激活回调来处理每条消息来对传入消息做出反应。为了部署 ROS 应用程序，各个节点被分发到主机，然后映射到操作系统进程。 ROS2客户端库中的执行器协调操作系统进程中节点回调的执行。 </span><span style="background:#40a9ff">ROS2 提供了两种内置执行器：一种是在单个线程中执行回调的顺序执行器，另一种是在多个线程之间分配待处理回调的处理。</span>与[6]相同，本文考虑了作为在单线程执行器上执行的处理链（如图1-（b）所示）实现的应用程序，其中工作负载必须顺序执行。链中的每个顶点代表一个回调1。处理链通常以系统计时器激活的计时器回调开始，然后是可能跨越多个执行器的几个常规回调。在本文中，我们将注意力限制在计算单个执行器上的链的响应时间上。然而，与[6]中相同，我们可以通过组合性能分析（CPA）方法轻松地将我们的结果扩展到跨多个执行器的链的端到端响应时间分析[26]-[29]。


![image.png](https://raw.githubusercontent.com/wsm6636/pic/main/202405161128817.png)


## A. 工作负载模型




***

# 笔记

## 1 论文创新在于

## 2 解决了什么问题

## 3 方法

## 4 不足&可继续研究

## 5 可参考

## 6 思考
