---
created: 2024-05-03T18:55:00
updated: 2024-05-03T12:15
tags:
  - 笔记
  - 笔记/文献笔记
  - 待归档
status:
  - ing
---
 



**TitleTranslation:**  SEAM：ROS 中具有有界时间差的最佳消息同步器
**Journal or Conference:**   2023 IEEE Real-Time Systems Symposium (RTSS)  
**Authors:**  JinghaoSun, TianyiWang, YangLi, NanGuan, ZhishanGuo, GuozhenTan
**Pub.date:**  2023-12
**DOI:**  10.1109/RTSS59052.2023.00024
**tags:** #schedule, /ing
**zoterolink:**  [zotero](zotero://select/library/items/MIYTDDHY)

# 摘要

自主机器通常受到实时限制。 ROS 2是一种广泛使用的机器人框架，将实时能力视为关键因素，并不断发展以应对这些挑战，例如端到端时序保证和实时数据融合等。本文研究了ROS消息同步器，这是多传感器数据融合的一个组成部分，并为ROS 2未来版本中同步器的演进提供了潜在的方向。为了有效的数据融合，来自不同传感器的输入数据必须在对齐的时间点进行采样在特定范围内。本文提出了一种新颖的消息同步策略来满足这一要求，称为 SEAM，一旦最早到达的消息落入指定范围内，它就会对其进行同步。与传统的 ROS 同步器不同，SEAM 不依赖预测信息进行复杂的优化。相反，它使用来自已到达消息的信息来构建可行的同步方案。我们通过证明 SEAM 总能找到可行的方案（如果确实存在）来证明 SEAM 的最优性。我们将 SEAM 集成到 ROS 2 中，并进行实验来评估其与传统 ROS 同步器相比的有效性。



> 
> ***
> 
> # 笔记
> 
> ## 1 论文创新在于
> 
> ## 2 解决了什么问题
> 
> ## 3 方法
> 
> ## 4 不足&可继续研究
> 
> ## 5 可参考
> 
> ## 6 思考




# 1引言

自主机器的时代即将到来。从移动机器人和自动驾驶汽车到送货无人机，自主机器在我们的日常生活中变得越来越普遍，并有可能彻底改变我们的生活、工作和与世界互动的方式[1]。机器人操作系统 (ROS) [2] 是最流行的开源机器人框架，提供了一组库和工具来解决构建自主系统中的许多普遍问题。


为了提取一些共同特征，自主机器由许多相互作用的组件和传感器组成，它们可以感知周围环境并具有相应的决策和反应的智能。由于许多自主机器对安全至关重要，因此它们必须遵守时间限制，以确保机器及其环境的正确功能和安全。一般来说，自主机器的时序约束可以分为以下两个方面


**端到端的时序保证。**
与其他计算系统不同，自主机器具有非常深的处理管道，不同组件之间以及各种本地和端到端时间限制之间具有很强的依赖性。图1显示了自动驾驶系统（ADS）的处理图的示例。从左侧开始，系统消耗来自毫米波雷达、LiDAR、摄像头和 GNSS/IMU 的原始传感数据。处理组件使用最新的输入数据执行计算并向下游组件产生输出。具有高实时性能的自主机器必须快速响应周围环境的变化。这意味着他们必须在有限的端到端时间范围内处理传感数据并做出决策，因为即使是微小的延迟也会对运营有效性甚至安全性产生重大影响。


**消息同步的时间差异**。
自主机器高度依赖融合多传感器数据来精确感知周围环境并做出智能决策。数据融合的主要难点是自主机器中的传感器以不同的频率采样数据并输出消息（如图1所示），并且融合算法可能会接收到具有不同采样的消息（从多个传感器发送的）时间（也称为时间戳）。我们将消息时间戳之间的差异称为时间差异（参见第三节中的正式定义）。用于融合的消息（来自不同的传感器，例如相机和激光雷达，如图 1 所示）的巨大时间差异可能会构建不准确的周围环境视图并扰乱未来的决策。
![image.png](https://gcore.jsdelivr.net/gh/wsm6636/pic/202405031103614.png)


为了解决上述自主机器复杂的计时问题，ROS经过全面重构，演变成ROS 2。一方面，ROS 2将端到端的计时能力作为关键考虑因素，它利用了数据分发服务（Data Distribution Service）（ DDS）作为进程间通信中间件，以促进高效的实时数据交换。它还在实时操作系统之上集成了一个额外的调度程序抽象，称为“执行器”，为处理相互依赖的组件功能奠定了良好的基础，从而可以提供端到端的时序保证。


另一方面，ROS采用消息同步器来减少数据输入到融合组件的时序差异，这一概念被ROS 2直接继承。


与建立在远离 ROS 1 的改进基础上的其他 ROS 2 概念（例如执行器）不同，消息同步器组件从 ROS 1 C++ 版本“Diamondback”[4] 到当前的 ROS 2 C++ 版本“保持不变”谦虚”[5]。


确实，ROS 2还有改进的空间。本文旨在探索和确定 ROS 2 中消息同步策略演变的潜在方向，这些策略能够更好地支持自主机器中多传感器的数据融合。


数据融合算法通常要求要融合的消息之间的时间差在一定范围内。


然而，现有的ROS消息同步器过分强调最小化时间差异，忽略了融合算法的基本要求，即消息的时间差异只需位于指定范围内，这就是本文的动机


ExactTime 策略选择具有完全相同时间戳的消息来创建输出消息，并丢弃那些找不到精确匹配的消息。在 ExactTime 策略下，任何输出消息的时间差几乎都是 0。尽管如此，ExactTime 策略在实践中很少使用，因为要求来自不同传感器的数据具有相同的时间戳过于严格。




ApproximateTime 策略有助于将消息与不同的时间戳同步，并预测传入消息的到达时间，以识别那些具有最小可能时间差异的消息。 ApproximateTime 策略的局限性之一是它严重依赖于传入消息的准确预测，因此，如果这些预测不够精确，其性能可能会显着恶化。此外，ApproximateTime 策略是短视的，因为它只专注于最小化消息组在当前时间点的时间差异，可能忽略了可能超出范围的未来同步。因此，它不能总是确定可行的同步策略。


综上所述，如何同步消息以保证它们的时间差异始终落在一定范围内仍然是ROS 2社区中的一个悬而未决的问题。


在本文中，我们提出了一种新颖的消息同步器，它利用一个简单的策略：一旦最早到达的消息落入特定范围，就对其进行同步。因此，我们将其命名为 SEAM，这是由保单中单词的第一个字母组成的首字母缩写词。与 ApproximateTime 同步器相比，SEAM 同步器的优点是无需预测传入消息，因为它仅根据已到达消息的时间戳来确定应同步哪些消息。


最重要的是，我们证明SEAM同步策略是最优的，即对于任何消息序列，如果存在一种同步方案可以对消息进行分组，使得每组中的消息的时间差异落在指定的范围内，SEAM同步器总是能够找到该方案。


我们将SEAM同步器合并到ROS 2（Dashing版本）的消息过滤器包中，并进行实验来评估使用SEAM同步器与传统ROS同步器相比成功同步消息序列的比例。实验结果表明，SEAM同步器显着提高了成功率，且计算时间仅为传统ROS消息同步器的五分之一。


本文的其余部分安排如下。我们首先在第 2 节中概述了多传感器数据融合和 ROS 的消息同步器。 II，然后我们在Sec.中介绍消息同步的问题模型。三．我们在第 2 节中提出了 SEAM 同步策略。四．在秒。 V，我们在 ROS 2 中实现了 SEAM 策略。实验结果在第 2 节中报告。六．相关工作在第 2 节中给出。七．结束语在第 2 节中作出。八．


二. ROS 2 中消息同步器概述


在 ROS 2 中，消息同步器从多个传感器接收数据，有选择地处理输入，并将所选消息转发到融合组件进行进一步处理，如图 2 所示。


理想情况下，融合算法假设来自不同传感器的输入数据是同时采样的。


然而，由于固有的硬件特性（例如，不同的传感器可能具有不同的采样频率和时钟漂移）和软件相关的延迟（例如，由传感器数据的预处理和传输引起）[6]，这种假设在现实中很少成立。 


已经提出了各种技术来补偿输入数据的时间不一致性[7]。


然而，如果时间不一致超出其可容忍范围，则这种补偿可能无法在运行时提供预期的质量。


这就激发了本文考虑的问题：如何确保用于融合的消息的时间戳之间的差异在给定阈值范围内？


这就激发了本文考虑的问题：如何确保用于融合的消息的时间戳之间的差异在给定阈值范围内？在本节中，我们将概述 ROS 2 中的标准消息同步器，并分析它们是否有效地限制了输入数据的时间不一致。在详细介绍之前，我们首先介绍一些有用的符号，如下所示。


消息同步器的输入。消息同步器由多个输入通道组成，通道总数限制为 9 [8]。每个通道都有一个缓冲队列，用于临时存储该特定通道的传入消息（通常由同一传感器定期生成）。


每条消息都包含一个时间戳，表示对消息封装的传感器数据进行采样的时间。


由于消息在到达消息同步器之前可能会经历一些延迟，因此消息的时间戳通常与其到达时间不同。


我们假设同一队列中的消息按照与其时间戳相同的顺序到达。 ROS 2 结合了一些机制来处理消息未按预期顺序传递的情况。更具体地说，ROS 2 针对此类情况发出警告（作为参考，请参阅“checkInterMessageBound()”函数，第 30 行）[9]。我们的方法可以很容易地扩展到处理某些消息没有按时间顺序到达的情况：当收到上述警告时，我们可以暂时缓冲乱序消息，以确保发送到同步器的所有消息按时间顺序排列。


消息同步器的输出。


消息同步器从每个队列中选择单个消息以形成输出消息集，然后将其转发到融合组件。在ROS消息过滤器的默认同步策略中，一条消息不能被多次使用。因此，在本文中，我们假设所选消息在用于形成输出消息集后必须从队列中删除。我们坚持这个假设是为了与 ROS 中的默认同步策略保持一致。消息集合的时间差异是指集合内消息之间时间戳的最大差异。本文要解决的问题是设计一个消息同步器，使其每个输出消息集都具有有界的时间差异。

