---
created: 2024-03-15T15:53
updated: 2024-03-15T23:02
tags:
  - 笔记
  - 笔记/idea
---

> 外部事件触发的时间tz
> 认为外部事件是任务链中第一个任务，编号为c0
> 第一个采样任务τ0为c1，fτ0也就是tc1
> 外部事件z的结束时间为tc0，也就是任务0的释放时间r0
> 其中t0就是r1
> 

最大反应时间衡量从外部活动到数据完全由系统处理的时刻的时间
最大数据年龄测量从数据采样到基于该采样的激励的时间


z是外部活动时刻
z'是驱动事件时刻

端到端时延都是z'-z
最大反应时间：z是外部活动触发的时间，z'是链的最后一个任务结束时间（处理完由于外部活动产生的数据，但并不包括将处理结果用于驱动其他任务）
最大数据年龄：z是链的第一个任务开始时间（不考虑外部活动触发，只考虑外部活动之后第一个开始处理数据的任务），z'是链的最后一个任务结束时间==（将数据写入缓冲区？）==

> 他们的最后一个任务的时间是否是一样的？
> 最大数据年龄需要多考虑一个任务的时间吗？？？？
> （切割考虑了，但是QBV没有）
> 如果考虑的话，通过事件触发和资源曲线怎么分析

> 数据年龄最后一个任务的时间一样：因为对于事件触发的任务链，最后一个任务处理完数据后，下一个任务才会激励
> 激励事件（最后一个任务的下一个任务），的释放时间（被触发的时间），和最后一个任务的结束时间相等

$$\begin{equation}
\begin{aligned}
R(C) & = t'-t\\
     & = f(c_n) - r(c_1)\\
     & = t(c_n) - t(c_0)\\
     & = \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
\end{aligned}
\end{equation}$$


# bug
#### 任务链
**我们考虑由一系列事件c组成的任务链C={z, c0，c1，c2，...，cn}。所有事件c按序处理在t时刻外部事件z产生的初始数据，并在时刻t'由最后一个事件cn产生关于该数据的最终结果。**

我们考虑由一系列事件c组成的任务链==C={z, c1，c2，c3，...，cn}==。所有事件c按序处理在t时刻外部事件z产生的初始数据，并在时刻t'由最后一个事件cn产生关于该数据的最终结果。

**定义1（任务链）：任务链C={z, c0，c1，c2，...，cn}满足：
- **任务链C中的事件c0和cn只能是调度任务 $\tau_0$ and $\tau_n$,，即c0和cn只能存在于ECU上。**
- **c0是一个ECU上的周期性调度任务$\tau_0$，且周期为T，用来定期捕捉外部事件z**
- **对于外部事件z，当且仅当其发生在CPU空闲时才有效。**
- **对于任意事件ci （1<i<n-1），可以是调度任务也可以是网络任务。**
- **不存在两个连续的事件ci和ci-1（1<i<n-1）为分别在不同ECU上执行的调度任务情况。在任务链上，不同ECU上执行的两个调度任务中间至少有一个网络任务作为连接。例如，ci-1和 ci+1为不同ECU上的调度任务，则ci为一个网络任务。**

定义1（任务链）：任务链==C={z, c1，c2，c3，...，cn}==满足：
- 任务链C中的事件c1和cn只能是调度任务 $\tau_0$ and $\tau_n$,，即c1和cn只能存在于ECU上。
- c1是一个ECU上的周期性调度任务$\tau_0$，且周期为T，用来定期捕捉外部事件z
- ==对于外部事件z，可将其看做任务链的第0个事件，即外部事件z是c0==
- 对于任意事件ci （1<i<n-1），可以是调度任务也可以是网络任务。
- 不存在两个连续的事件ci和ci-1（1<i<n-1）为分别在不同ECU上执行的调度任务情况。在任务链上，不同ECU上执行的两个调度任务中间至少有一个网络任务作为连接。例如，ci-1和 ci+1为不同ECU上的调度任务，则ci为一个网络任务。

#### 结束时间
**定义4 （结束时间）：对于任务链$C = \{z, c_0, c_1, c_2, ... , c_n\}$中的每一个事件，$t(\cdot )$为事件的结束时间：
**- 对于外部事件z，$t(z)$为外部事件发生的时间。**
**- 对于ECU上的调度任务$\tau_i$来说$t(c_i)$为调度任务$\tau_i$的结束时间$f(c_i)$。**
**- 对于网络任务$m_i$来说$t(c_i)$为结束时间$d(c_i)$。


定义4 （结束时间）：对于==任务链$C = \{z, c_1, c_2, c_3, ... , c_n\}$中的每一个事件，==$t(\cdot )$为事件的结束时间：
- 对于外部事件z，$t(z)$为外部事件发生的时间，t(c0)为外部事件结束时间。根据定义1可知，外部事件z也是任务链的事件c0。外部事件的结束时间就是当外部事件触发后，下一个将要捕捉此外部事件z的周期性调度任务τ0对应的作业的释放时间。
- 对于ECU上的调度任务$\tau_i$来说$t(c_i)$为调度任务$\tau_i$的结束时间$f(c_i)$。
- 对于网络任务$m_i$来说$t(c_i)$为结束时间$d(c_i)$。


$$\begin{equation}
\begin{aligned}
R(C) & = t'-t\\
     & = t(c_n) - t(z)\\
     & = t(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
     & = t(c_0) - r(c_0) + r(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
     & = f(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
\end{aligned}
\end{equation}$$


$$\begin{equation}
\begin{aligned}
R(C) & = t'-t\\
     & = t(c_n) - t(z)\\
     & = t(c_1) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
     & = t(c_1) - r(c_1) + r(c_1) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
     & = t(c_1) - t(c_0) + t(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
     & = t(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\\
\end{aligned}
\end{equation}$$


**则最大反应时间根据公式（）为$\max\{f(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\}$

则最大反应时间根据公式（）为$\max\{t(c_0) - t(z) + \sum_{i=1}^{n}(t(c_i) - t(c_{i-1}))\}$

#### 第一部分上界
**证明，根据定义（1），我们可以获得事件$c_0$的定义，即事件$c_0$必然是一个调度任务为$\tau_0$，所以根据定义（4）调度任务$\tau_0$的结束时间为$f(\tau_0)=f(c_0)$。继续使用定义（1），事件$c_0$（调度任务$\tau_0$）以T为周期捕捉外部事件z，所以当外部事件在t(z)开始触发之后最晚在一个周期T之内，它将被调度任务$\tau_0$捕捉。所以我们可以得到$f(c_0)-t(z)$的上界为T。


证明，根据定义（1），我们可以获得事件$c_1$的定义，即事件$c_1$必然是一个调度任务为$\tau_0$，所以根据定义（4）外部事件z的结束时间为$t(c_0)=r(c_1)=r(\tau_0)$。继续使用定义（1），事件$c_1$（调度任务$\tau_0$）以T为周期捕捉外部事件z，所以当外部事件在t(z)开始触发之后最晚在一个周期T之内，它将被调度任务$\tau_0$捕捉。所以我们可以得到$t(c_0)-t(z)$的上界为T。